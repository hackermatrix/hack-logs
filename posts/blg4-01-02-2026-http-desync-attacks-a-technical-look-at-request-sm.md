# HTTP Desync Attacks: A Technical Look at Request Smuggling\n\n## Introduction: The Dual Interpretation Problem\n\nHTTP Request Smuggling, or a Desync Attack, is an advanced vulnerability that arises when an application uses two or more HTTP servers (such as a load balancer and a back-end server) to process requests, and these servers interpret the boundary between requests differently. This disagreement allows an attacker to "smuggle" a second, malicious request inside the first.\n\n## The Key Headers: Content-Length and Transfer-Encoding\n\nThe attack exploits the ambiguity caused by the presence of two conflicting headers:\n\n*   ** (CL):** Specifies the body size in bytes.\n*   ** (TE):** Uses chunked encoding, where the body is terminated by a chunk size of zero (`0\r\n\r\n`).\n\nThere are two primary attack variations based on which header the front-end (FE) and back-end (BE) servers prioritize:\n\n### 1. CL-TE Vulnerability (FE uses CL, BE uses TE)\n\n1.  FE reads the `Content-Length` (CL) value and forwards that many bytes.\n2.  BE ignores CL, uses `Transfer-Encoding` (TE), and stops reading at the zero-chunk.\n3.  The attacker creates a request where the CL value is short, hiding malicious bytes past the CL boundary. The BE server processes the hidden malicious bytes as the start of the *next* victim's request.\n\n### 2. TE-CL Vulnerability (FE uses TE, BE uses CL)\n\n1.  FE reads the `Transfer-Encoding` (TE) and forwards the body until the zero-chunk.\n2.  BE ignores TE, reads the `Content-Length` (CL) value, and stops reading prematurely.\n3.  The attacker uses a corrupted TE to trick the FE, while the BE stops reading based on a short CL, leaving trailing malicious bytes in the buffer for the next request.\n\n## Mitigation\n\nThe vulnerability can be mitigated by:\n*   **Never trust client input:** Reject requests with both CL and TE headers.\n*   **Standardization:** Ensure all servers in the chain are running compatible software and strictly follow HTTP/1.1 specifications regarding header priority.\n*   **Web Application Firewalls (WAF):** Configure WAF rules to drop suspicious request patterns and non-standard HTTP headers.